<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Retro Olympics</title>
        <link rel="icon" type="image" href="img/favicon.ico">

        <!--custom CSS link-->
        <link rel="stylesheet" type="text/css" href="style.css">
        <link rel="stylesheet" type="text/css" href="css/schedule.css">

        <!---boxicons link--->
        <link rel="stylesheet"
        href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">

        <!---remixicon link-->
        <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">

        <!---google fonts link-->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Pixelify+Sans&display=swap" rel="stylesheet">
        
    </head>
    <body>
        <script type="module" src="js/elements.js"></script>

        <header>
            <a href="index.html" class="logo">
                <img src="img/logo.png" alt="Retro Olympics">
            </a>

            <ul class="navlist">
                <li><a href="teams.html">Teams</a></li>
                <li><a href="standings.html">Standings</a></li>
                <li><a href="schedule.html">Schedule</a></li>
                <li><a href="games.html">Games</a></li>
                <li><a href="volunteers.html">Volunteers</a></li>
                <li><a href="history.html">History</a></li>
            </ul>

            <div class="bx bx-menu" id="menu-icon"></div>
        </header>

        <section class="hero">
        <div id="schedule-container"></div>
        </section>

        <script type="module">
            "use strict";
            const container = document.getElementById("schedule-container");
            const groups = await fetch("/json/teams.json").then(res => res.json());
            const allgames = await fetch("/json/games.json").then(res => res.json());
            const schedule = await fetch("/json/schedule.json").then(res => res.json());
            let output = "";
            for (const week of schedule) {
                const date = new Date(`${week.date}T${week.timeslots[0].time}Z`).toDateString();
                output += `<div class="schedule"><div class="header"><span>${week.name}</span>${date}</div>`;
                output += `<div class="table">
                    <div class="row">
                        <span class="head">Hosts</span>
                        <span class="head">Time</span>
                        <span class="head">Group</span>
                        <span class="head">Matchup</span>
                        <span class="head">Results</span>
                    </div>
                `;
                for (const slot of week.timeslots) {
                    const team1 = groups[slot.group][slot.team1 - 1];
                    const team2 = groups[slot.group][slot.team2 - 1];
                    const games = allgames.find(gr => gr.groupname === week.name).games;
                    const icons = [ "img/unown.png", team1.icon, team2.icon ];
                    output += `<div class="row">
                        <div class="hosts">
                            <ra-userpic>${slot.hosts[0]}</ra-userpic>
                            <ra-userpic>${slot.hosts[1]}</ra-userpic>
                        </div>
                        <div class="time">
                            ${new Date(`${week.date}T${slot.time}Z`).toLocaleTimeString()}
                        </div>
                        <div class="group">Group ${slot.group}</div>
                        <div class="matchup">
                            <div class="matchup-team"><img src="${icons[1]}">${team1.name}</div>
                            <div>VS</div>
                            <div class="matchup-team"><img src="${icons[2]}">${team2.name}</div>
                        </div>
                        <div class="results">
                            <img class="game" src="${games[0].image}">
                            <img class="game" src="${games[1].image}">
                            <img class="game" src="${games[2].image}">
                    `;
                    for (let i = 0; i < 3; i++) {
                        output += `<img class="result" src="${icons[slot.results[i]]}">`;
                    }
                    output += "</div></div>";
                }
                output += "</div></div>";
            }
            container.innerHTML = output;
        </script>
    </body>
</html>
